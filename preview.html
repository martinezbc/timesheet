<!DOCType html>

<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Transportation Weekly Report</title>
    <!--Stylesheet-->
    <link href="https://fonts.googleapis.com/css?family=Montserrat|Roboto|Rubik" rel="stylesheet">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css" integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous">
    <link href="css/bootstrap-grid.css" rel="stylesheet" type="text/css">
    <link href="css/stylesheet.css" rel="stylesheet" type="text/css">
    <link href="css/color.css" rel="stylesheet" type="text/css">
    <style>
        .bold {
            font-weight: bold;
        }
        
        .bold-lg {
            font-weight: bold;
            font-size: 16px;
        }
        
        .section__header {
            padding: 5px;
            border-radius: 4px;
            margin-top: -2px;
        }
        
        p {
            font-family: 'Rubik';
            text-transform: none;
            font-weight: normal;
            font-size: 14px;
        }
    </style>
    <!--Javascript-->
    <script>
        function getStorage(refID) {
            return localStorage.getItem(refID);
        }
    </script>
</head>

<body>
    <div class="header">
        <h1 class="header__title">TRANSPORTATION WEEKLY REPORT</h1>
        <p>DOWNLOAD TIMESHEET HERE-></p>
        <div id="navbarmodal" class="dropdown">
            <!--navmodal-->
            
            <span class="fas fa-bars dropbtn" id="tsbtn" onclick="myFunction();"></span>
            <div class="dropdown-content" id="tsdropdown">
                <div class="row" onclick="location.href='timesheet.html';"><span class="fas fa-file-download"></span>&nbsp;Download</div>
                <div class="row" onclick="location.href='index.html';"><span class="fas fa-backward"></span>&nbsp;Go Back</div>
            </div>
        </div>
    </div>
    <div class="main">
        <div class="topspacer"></div>
        <div class="card bg-burntred">
            <div style="font-size: 20px">TIMESHEET PREVIEW - After reviewing data, click on download from the menu bar to create the PDF.</div>
        </div>
        <div class="card">
            <script>
                var strHTML = "";
                strHTML += '<div class="row section__header bg-medblue">';
                strHTML += '<div class="col-12 bold-lg">Employee Data</div></div>';
                strHTML += '<div class="row"><div class="col-sm-3"><p class="bold">Area:</p><p>' + getStorage("Area") + '</p></div>';
                strHTML += '<div class="col-sm-3"><p class="bold">Team:</p><p>' + getStorage("Team") + '</p></div>';
                strHTML += '<div class="col-sm-6"><p class="bold">Name:</p><p>' + getStorage("EmpName") + '</p></div>';
                strHTML += '<div class="row"><div class="col-sm-3"><p class="bold">Week Range:</p><p>' + getStorage("WeekOf") + '</p></div>';
                strHTML += '<div class="col-sm-3"><p class="bold">Position:</p><p>' + getStorage("Position") + '</p></div>';
                strHTML += '<div class="col-sm-1"><p class="bold">OJT Trainer:</p><p>';
                if (getStorage('OJT') === '1') {
                    strHTML += '<input type="checkbox" checked="checked" disabled>';
                } else {
                    strHTML += '<input type="checkbox" disabled>';
                }
                strHTML += '</p></div><div class="col-sm-2"><p class="bold">Trainee:</p><p>' + getStorage("Trainee") + '</p></div>';
                strHTML += '<div class="col-sm-1"><p class="bold">Vehicle:</p><p>' + getStorage("Veh1") + '</p></div>';
                strHTML += '<div class="col-sm-2"><p class="bold">Spares:</p><p>' + ((getStorage("Veh2") !== "") ? getStorage("Veh2") : "") + ((getStorage("Veh3") !== "") ? "/" + getStorage("Veh3") : "") + ((getStorage("Veh4") !== "") ? "/" + getStorage("Veh4") : "") + '</p></div></div>'
                document.write(strHTML);
            </script>
        </div>
        
        <script>
            strHTML = '<div class="card">';
            var days = ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"];
            if (getStorage("Position") === "Driver" || getStorage("Position") === "Sub Driver" || getStorage("Position") === "Driver Trainee") {    
                strHTML += '<div class="row section__header bg-medblue"><div class="col-12 bold-lg">Pupil Counts</div></div>';
                strHTML += '<hr class="border-grey">';
                strHTML += '<div class="row">';
                strHTML += '<div class="col-sm-2"><p class="bold">AM 1st Bell:&nbsp;' + getStorage("AMRoute1") + '</p></div>';
                for (var i = 1; i < 6; i++) {
                    strHTML += '<div class="col-sm-1"><p>' + days[i].substr(0,1) + ':&nbsp;' + getStorage(days[i] + "AM1Ct") + '</p></div>';    
                }
                strHTML += '</div><div class="row">';
                strHTML += '<div class="col-sm-2"><p class="bold">AM 2nd Bell:&nbsp;' + getStorage("AMRoute2") + '</p></div>';
                for (i = 1; i < 6; i++) {
                    strHTML += '<div class="col-sm-1"><p>' + days[i].substr(0,1) + ':&nbsp;' + getStorage(days[i] + "AM2Ct") + '</p></div>';    
                }
                strHTML += '</div><div class="row">';
                strHTML += '<div class="col-sm-2"><p class="bold">AM 3rd Bell:&nbsp;' + getStorage("AMRoute3") + '</p></div>';
                for (i = 1; i < 6; i++) {
                    strHTML += '<div class="col-sm-1"><p>' + days[i].substr(0,1) + ':&nbsp;' + getStorage(days[i] + "AM3Ct") + '</p></div>';    
                }
                strHTML += '</div><div class="row">';
                strHTML += '<div class="col-sm-2"><p class="bold">AM 4th Bell:&nbsp;' + getStorage("AMRoute4") + '</p></div>';
                for (i = 1; i < 6; i++) {
                    strHTML += '<div class="col-sm-1"><p>' + days[i].substr(0,1) + ':&nbsp;' + getStorage(days[i] + "AM4Ct") + '</p></div>';    
                }
                strHTML += '</div><div class="row">';
                strHTML += '<div class="col-sm-2"><p class="bold">AM 5th Bell:&nbsp;' + getStorage("AMRoute5") + '</p></div>';
                for (i = 1; i < 6; i++) {
                    strHTML += '<div class="col-sm-1"><p>' + days[i].substr(0,1) + ':&nbsp;' + getStorage(days[i] + "AM5Ct") + '</p></div>';    
                }
                strHTML += '</div><div class="row"><div class="col-sm-2"></div>';
                for (i = 1; i < 6; i++) {
                    strHTML += '<div class="col-sm-1"><p>' + getStorage(days[i] + "TimeA") + '</p></div>';    
                }
                strHTML += '</div><div class="row"><div class="col-sm-2"></div>';
                for (i = 1; i < 6; i++) {
                    strHTML += '<div class="col-sm-1"><p>' + getStorage(days[i] + "TimeB") + '</p></div>';    
                }
                strHTML += '</div><hr class="border-grey"><div class="row">';
                strHTML += '<div class="col-sm-2"><p class="bold">PM 1st Bell:&nbsp;' + getStorage("PMRoute1") + '</p></div>';
                for (i = 1; i < 6; i++) {
                    strHTML += '<div class="col-sm-1"><p>' + days[i].substr(0,1) + ':&nbsp;' + getStorage(days[i] + "PM1Ct") + '</p></div>';    
                }
                strHTML += '</div><div class="row">';
                strHTML += '<div class="col-sm-2"><p class="bold">PM 2nd Bell:&nbsp;' + getStorage("PMRoute2") + '</p></div>';
                for (i = 1; i < 6; i++) {
                    strHTML += '<div class="col-sm-1"><p>' + days[i].substr(0,1) + ':&nbsp;' + getStorage(days[i] + "PM2Ct") + '</p></div>';    
                }
                strHTML += '</div><div class="row">';
                strHTML += '<div class="col-sm-2"><p class="bold">PM 3rd Bell:&nbsp;' + getStorage("PMRoute3") + '</p></div>';
                for (i = 1; i < 6; i++) {
                    strHTML += '<div class="col-sm-1"><p>' + days[i].substr(0,1) + ':&nbsp;' + getStorage(days[i] + "PM3Ct") + '</p></div>';    
                }
                strHTML += '</div><div class="row">';
                strHTML += '<div class="col-sm-2"><p class="bold">PM 4th Bell:&nbsp;' + getStorage("PMRoute4") + '</p></div>';
                for (i = 1; i < 6; i++) {
                    strHTML += '<div class="col-sm-1"><p>' + days[i].substr(0,1) + ':&nbsp;' + getStorage(days[i] + "PM4Ct") + '</p></div>';    
                }
                strHTML += '</div><div class="row">';
                strHTML += '<div class="col-sm-2"><p class="bold">PM 5th Bell:&nbsp;' + getStorage("PMRoute5") + '</p></div>';
                for (i = 1; i < 6; i++) {
                    strHTML += '<div class="col-sm-1"><p>' + days[i].substr(0,1) + ':&nbsp;' + getStorage(days[i] + "PM5Ct") + '</p></div>';    
                }
                strHTML += '</div><div class="row"><div class="col-sm-2"></div>';
                for (i = 1; i < 6; i++) {
                    strHTML += '<div class="col-sm-1"><p>' + getStorage(days[i] + "TimeC") + '</p></div>';    
                }
                strHTML += '</div><div class="row"><div class="col-sm-2"></div>';
                for (i = 1; i < 6; i++) {
                    strHTML += '<div class="col-sm-1"><p>' + getStorage(days[i] + "TimeD") + '</p></div>';    
                }
                strHTML += '</div><hr class="border-grey"><div class="row">';
                strHTML += '<div class="col-sm-2"><p class="bold">PAC/Preschool:&nbsp;' + getStorage("PSRoute1") + '</p></div>';
                for (i = 1; i < 6; i++) {
                    strHTML += '<div class="col-sm-1"><p>' + days[i].substr(0,1) + ':&nbsp;' + getStorage(days[i] + "PS1Ct") + '</p></div>';    
                }
                strHTML += '</div><div class="row">';
                strHTML += '<div class="col-sm-2"><p class="bold">PAC/Preschool:&nbsp;' + getStorage("PSRoute2") + '</p></div>';
                for (i = 1; i < 6; i++) {
                    strHTML += '<div class="col-sm-1"><p>' + days[i].substr(0,1) + ':&nbsp;' + getStorage(days[i] + "PS2Ct") + '</p></div>';    
                }
                strHTML += '</div><hr class="border-grey"><div class="row">';
                strHTML += '<div class="col-sm-2"><p class="bold">Shuttle:&nbsp;' + getStorage("SHRoute1") + '</p></div>';
                for (i = 1; i < 6; i++) {
                    strHTML += '<div class="col-sm-1"><p>' + days[i].substr(0,1) + ':&nbsp;' + getStorage(days[i] + "SH1Ct") + '</p></div>';    
                }
                strHTML += '</div><div class="row">';
                strHTML += '<div class="col-sm-2"><p class="bold">Shuttle:&nbsp;' + getStorage("SHRoute2") + '</p></div>';
                for (i = 1; i < 6; i++) {
                    strHTML += '<div class="col-sm-1"><p>' + days[i].substr(0,1) + ':&nbsp;' + getStorage(days[i] + "SH2Ct") + '</p></div>';    
                }
                strHTML += '</div><hr class="border-grey"><div class="row">';
                strHTML += '<div class="col-sm-2"><p class="bold">Late Run:&nbsp;' + getStorage("LRRoute1") + '</p></div>';
                for (i = 1; i < 6; i++) {
                    strHTML += '<div class="col-sm-1"><p>' + days[i].substr(0,1) + ':&nbsp;' + getStorage(days[i] + "LR1Ct") + '</p></div>';    
                }
                strHTML += '</div><div class="row">';
                strHTML += '<div class="col-sm-2"><p class="bold">Late Run:&nbsp;' + getStorage("LRRoute2") + '</p></div>';
                for (i = 1; i < 6; i++) {
                    strHTML += '<div class="col-sm-1"><p>' + days[i].substr(0,1) + ':&nbsp;' + getStorage(days[i] + "LR2Ct") + '</p></div>';    
                }
                strHTML += '</div></div>'
                document.write(strHTML);
            }
        </script>
        
        <div class="card">
            <script>
                strHTML = "";
                strHTML += '<div class="row section__header bg-medblue"><div class="col-12 bold-lg">Route Time</div></div>';
                for (var i = 1; i < 6; i++) {
                    if (i !== 2) {strHTML += '<hr class="border-grey">';}
                    strHTML += '<div class="row">';
                    strHTML += '<div class="col-sm-1"><p class="bold">' + getStorage(days[i] + "Date") + '</p></div>';
                    strHTML += '<div class="col-sm-2"><p>RG:&nbsp;' + getStorage(days[i] + "Time11S") + '&nbsp;&nbsp;' + getStorage(days[i]+ "Time11E") + "&nbsp;&nbsp;" + getStorage(days[i] + "Time11") + '</p></div>';
                    strHTML += '<div class="col-sm-2"><p>PS:&nbsp;' + getStorage(days[i] + "Time13S") + '&nbsp;&nbsp;' + getStorage(days[i] + "Time13E") + "&nbsp;&nbsp;" + getStorage(days[i] + "Time13") + '</p></div>';
                    strHTML += '<div class="col-sm-2"><p>SH:&nbsp;' + getStorage(days[i] + "Time15S") + '&nbsp;&nbsp;' + getStorage(days[i] + "Time15E") + "&nbsp;&nbsp;" + getStorage(days[i] + "Time15") + '</p></div></div>';
                    strHTML += '<div class="row"><div class="col-sm-1">';
                    if (getStorage(days[i] + "Lift1") === "1") {
                        strHTML += '<p class="bold">EQ/L&nbsp;<input type="checkbox" checked="checked" disabled></p></div>';
                    } else {
                        strHTML += '<p class="bold">EQ/L&nbsp;<input type="checkbox" disabled></p></div>';
                    }
                    strHTML += '<div class="col-sm-2"><p>RG:&nbsp;' + getStorage(days[i] + "Time12S") + '&nbsp;&nbsp;' + getStorage(days[i] + "Time12E") + "&nbsp;&nbsp;" + getStorage(days[i] + "Time12") + '</p></div>';
                    strHTML += '<div class="col-sm-2"><p>PS:&nbsp;' + getStorage(days[i] + "Time14S") + '&nbsp;&nbsp;' + getStorage(days[i] + "Time14E") + "&nbsp;&nbsp;" + getStorage(days[i] + "Time14") + '</p></div>';
                    strHTML += '<div class="col-sm-2"><p>SH:&nbsp;' + getStorage(days[i] + "Time16S") + '&nbsp;&nbsp;' + getStorage(days[i] + "Time16E") + "&nbsp;&nbsp;" + getStorage(days[i] + "Time16") + '</p></div>';
                    strHTML += '<div class="col-sm-2"><p>LR:&nbsp;' + getStorage(days[i] + "Time17S") + '&nbsp;&nbsp;' + getStorage(days[i] + "Time17E") + "&nbsp;&nbsp;" + getStorage(days[i] + "Time17") + '</p></div>';
                    strHTML += '<div class="col-sm-2"><p>TOTAL:&nbsp;' + getStorage(days[i] + "RunTotal") + '</p></div></div>';
                }
            document.write(strHTML);
            </script>
        </div>
        <div class="card">
            <script>
                strHTML = "";
                strHTML += '<div class="row section__header bg-medblue"><div class="bold-lg">Other Work Duties</div></div>';
                var otherWork = ["OW0", "OW1", "OW2", "OW3", "OW4", "OW5", "OW6", "OW7", "OW8", "OW9"];
                var j = 0;
                for (i = 0; i < 7; i++) {
                    for (var k = 20; k < 30; k++) {
                        if ((days[i] === "Sat" || days[i] === "Sun") && k > 22) break;
                        if (getStorage(days[i] + "Select" + k) !== "") {
                            otherWork[j] = days[i] + "Time" + k;
                            j++;
                        }
                    }
                }
                var strDay = "";
                var blnOW = false;
                var strnum = "";
                
                for (i = 0; i < 10; i++) {
                    blnOW = (otherWork[i] !== "OW" + i) ? true : false;
                    if (blnOW) {
                        strDay = otherWork[i].substr(0,3);
                        strnum = otherWork[i].substr(7);
                        if (i !== 0) {strHTML += '<hr class="border-grey">';}
                        strHTML += '<div class="row">';
                        strHTML += '<div class="col-sm-1"><p>' + getStorage(strDay + "Date") + '</p></div>';
                        if (getStorage(strDay + "Lift" + strnum) === "1") {
                            strHTML += '<div class="col-sm-1"><p>EQ/L<input type="checkbox" checked="checked" disabled></p></div>';
                        } else {
                            strHTML += '<div class="col-sm-1"><p>EQ/L<input type="checkbox" disabled></p></div>';
                        }
                        strHTML += '<div class"col-sm-4"><p>Category:&nbsp;' + getStorage(strDay + "Select" + strnum) + " - " + getStorage(strDay + "Desc" + strnum) + '</p></div>';
                        strHTML += '<div class="col-sm-1"><p></p></div>';
                        strHTML += '<div class="col-sm-1"><p>' + getStorage(otherWork[i] + "S") + '</p></div>';
                        strHTML += '<div class="col-sm-1"><p>' + getStorage(otherWork[i] + "E") + '</p></div>';
                        strHTML += '<div class="col-sm-1"><p>' + getStorage(otherWork[i]) + '</p></div>';
                        strHTML += '</div>';
                    }
                }
                document.write(strHTML);
            </script>
        </div>
        <div class="card">
            <script>
                strHTML = "";
                strHTML += '<div class="row section__header bg-medblue"><div class="bold-lg">Field Trips</div></div>';

                var otherFT = ["FT0", "FT1", "FT2", "FT3", "FT4"];
                var j = 0;
                for (i = 0; i < 7; i++) {
                    for (var k = 30; k < 35; k++) {
                        if ((days[i] === "Sat" || days[i] === "Sun") && k > 32) break;
                        if (getStorage(days[i] + "Time" + k) !== "") {
                            otherFT[j] = days[i] + "Time" + k;
                            j++;
                        }
                    }
                }
                strDay = "";
                var blnFT = false;
                strnum = "";
                
                for (i = 0; i < 5; i++) {
                    blnFT = (otherFT[i] !== "FT" + i) ? true : false;
                    if (blnFT) {
                        if (i !== 0) {strHTML += '<hr class="border-grey">';}
                        strDay = otherFT[i].substr(0,3);
                        strnum = otherFT[i].substr(7);
                        strHTML += '<div class="row">';
                        strHTML += '<div class="col-sm-1"><p>' + getStorage(strDay + "Date") + '</p></div>';
                        if (getStorage(strDay + "Lift" + strnum) === "1") {
                            strHTML += '<div class="col-sm-1"><p>EQ/L<input type="checkbox" checked="checked" disabled></p></div>';
                        } else {
                            strHTML += '<div class="col-sm-1"><p>EQ/L<input type="checkbox" disabled></p></div>';
                        }
                        strHTML += '<div class="col-sm-2"><p>From:&nbsp;' + getStorage(strDay + "From" + strnum) + '</p></div>';
                        strHTML += '<div class="col-sm-2"><p>To:&nbsp;' + getStorage(strDay + "To" + strnum) + '</p></div>';
                        strHTML += '<div class="col-sm-2"><p>Voucher:&nbsp;' + getStorage(strDay + "Voucher" + strnum) + '</p></div>';
                        strHTML += '<div class="col-sm-1"><p>' + getStorage(otherFT[i] + "S") + '</p></div>';
                        strHTML += '<div class="col-sm-1"><p>' + getStorage(otherFT[i] + "E") + '</p></div>';
                        strHTML += '<div class="col-sm-1"><p>' + getStorage(otherFT[i]) + '</p></div>';
                        strHTML += '</div>';
                    }
                }
                document.write(strHTML);
            </script>
        </div>
        <div class="card">
            <script>
                strHTML = "";
                strHTML += '<div class="row section__header bg-medblue"><div class="bold-lg">Leave</div></div>';
                var otherLV = ["LV0", "LV1", "LV2", "LV3", "LV4", "LV5", "LV6", "LV7", "LV8", "LV9"];
                j = 0;
                for (i = 1; i < 6; i++) {
                    if (getStorage(days[i] + "Time41") !== "") {
                        otherLV[j] = days[i] + "Time41";
                        j++;
                    }
                    if (getStorage(days[i] + "Time42") !== "") {
                        otherLV[j] = days[i] + "Time42";
                        j++;
                    }
                    if (getStorage(days[i] + "LeaveAD") === "1") {
                        otherLV[j] = days[i] + "LeaveAD";
                        j++;
                    }
                }
                strDay = "";
                var blnLV = false;
                strnum = "";
                    
                for (i = 0; i < 10; i++) {
                    blnLV = (otherLV[i] !== "LV" + i) ? true : false;
                    if (blnLV) {
                        if (i !== 0) {strHTML += '<hr class="border-grey">';}
                        strHTML += '<div class="row">';
                        strDay = otherLV[i].substr(0,3);
                        strnum = otherLV[i].substr(-2);
                        strHTML += '<div class="col-sm-1"><p>' + getStorage(strDay + "Date") + '</p></div>';
                        strHTML += '<div class="col-sm-2"><p>' + getStorage(strDay + "LeaveSelect" + strnum) + '</p></div>';
                        if (strnum === "AD") {
                            strHTML += '<div class="col-sm-1"><p>All Day<input type="checkbox" checked="checked" disabled></p></div>';
                            strHTML += '<div class="col-sm-1"></div>';
                            strHTML += '<div class="col-sm-1"></div>';
                            strHTML += '<div class="col-sm-1"></div></div>';
                        } else {
                            strHTML += '<div class="col-sm-1"><p>All Day<input type="checkbox" disabled></p></div>';
                            strHTML += '<div class="col-sm-1"><p>' + getStorage(otherLV[i] + "S") + '</p></div>';
                            strHTML += '<div class="col-sm-1"><p>' + getStorage(otherLV[i] + "E") + '</p></div>';
                            strHTML += '<div class="col-sm-1"><p>' + getStorage(otherLV[i]) + '</p></div></div>';
                        }
                    }
                }
                document.write(strHTML);
            </script>
        </div>
        <div class="card">
            <script>
                strHTML = "";
                strHTML += '<div class="row section__header bg-medblue"><div class="bold-lg">Totals</div></div><div class="row">';
                strHTML += '<div class="col-sm-3"><p class="bold-lg">REGULAR:&nbsp;' + getStorage("TotalRun") + '</p></div>';
                strHTML += '<div class="col-sm-3"><p class="bold-lg">OTHER:&nbsp;' + getStorage("TotalOther") + '</p></div>';
                strHTML += '<div class="col-sm-3"><p class="bold-lg">FIELD TRIP:&nbsp;' + getStorage("TotalFT") + '</p></div>';
                strHTML += '<div class="col-sm-3"><p class="bold-lg">HOURS WORKED:&nbsp;' + getStorage("TotalHW") + '</p></div>';
                strHTML += '</div><hr class="border-grey"><div class="row">'
                strHTML += '<div class="col-sm-2"><p class="bold-lg">1R (Regular):&nbsp;' + getStorage("Total1R") + '</p></div>';
                strHTML += '<div class="col-sm-2"><p class="bold-lg">S4 (OJT):&nbsp;' + getStorage("TotalS4") + '</p></div>';
                strHTML += '<div class="col-sm-2"><p class="bold-lg">S2 (Equipment):&nbsp;' + getStorage("TotalS2") + '</p></div>';
                strHTML += '<div class="col-sm-2"><p class="bold-lg">C3 (Weather):&nbsp;' + getStorage("TotalC3") + '</p></div>';
                strHTML += '<div class="col-sm-2"><p class="bold-lg">C1 (Callback):&nbsp;' + getStorage("TotalC1") + '</p></div>';
                strHTML += '</div>';
                document.write(strHTML);
            </script>    
        </div>
    </div>
</body></html>
